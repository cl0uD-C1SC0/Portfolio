#
# UnauthorizedAccess:EC2/MaliciousIPCaller.Custom
#
# AWS WORKSHOP: https://hands-on-guardduty.awssecworkshops.com/

GuarDuty detectou um Acesso de um IP malicioso. Esse IP malicioso foi adicionado á um TXT na lista de ameaça.
Quando adicionamos uma lista de Ameaça e ela contém um IP, o GuardDuty lê este IP e qualquer acesso a uma EC2 vinda desse IP
ira gerar um Finding.

Quando gera um Finding ele vem com este nome: UnauthorizedAccess:EC2/MaliciousIPCaller.Custom
Ao gerar este Finding, o EventBridge é rapidamente acionado:

EventBridge contém estes parametros:
Event pattern:
    {
    "source": ["aws.guardduty"],
    "detail": {
        "type": ["UnauthorizedAccess:EC2/MaliciousIPCaller.Custom"]
    }
}
Event pattern 2:
{
  "source": [
    "aws.guardduty"
  ],
  "detail": {
    "type": [
      "UnauthorizedAccess:EC2/MaliciousIPCaller.Custom"
    ]
  }
}

Os targets são:
    1 Lambda function (Remediation-EC2MaliciousIPCaller.py)
    1 SNS Topic (Envia um E-mail de notificação)
