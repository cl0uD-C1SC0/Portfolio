#
# Policy:S3/BucketBlockPublicAccessDisabled
#
#
DETAILS FROM FINDING:
    "Amazon S3 Block Public Access was disabled for S3 bucket 
    guardduty-example-finance-455621539559-us-west-2 by GuardDuty-Example-Compromised2-Simulated calling 
    DeleteBucketPublicAccessBlock. If this behavior is not expected, it may indicate a configuration 
    mistake or that your credentials are compromised"

Motivo:
    Por algum motivo, o IP tal, fez uma chamada de API para o S3 que Permite o acesso publico ao S3.
    Quando o GuardDuty encontra esse Finding, um EventBridge é acionado por este Pattern:

    Event Pattern:
        {
        "source": ["aws.guardduty"],
        "detail": {
            "type": ["Policy:S3/BucketBlockPublicAccessDisabled", "Stealth:S3/ServerAccessLoggingDisabled"]
        }
    }

    Análises no EventBridge:
    Quando ele é acionado ele envia um SNS com os parametros:
        - Input Transform
        
        {"account":"$.detail.accountId","gdid":"$.detail.id","region":"$.detail.region","userName":"$.detail.resource.accessKeyDetails.userName"}

    Message To SNS:
        "GuardDuty Finding | ID:<gdid>: An AWS S3 related API operation was invoked by user (userName: <userName>) in account <account> . This activity seems suspicious. Please investigate with the user to check if this was expectated behaviour. Go to https://console.aws.amazon.com/guardduty/home?region=<region>#/findings?macros=current&fId=<gdid>"