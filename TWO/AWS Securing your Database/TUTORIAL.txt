#
#
#
https://aws.amazon.com/pt/premiumsupport/knowledge-center/eventbridge-human-readable-notifications/
https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-input-transformer-tutorial.html
https://aws.amazon.com/pt/premiumsupport/knowledge-center/eventbridge-human-readable-notifications/
https://aws.amazon.com/pt/blogs/database/customize-amazon-rds-events-notification-using-amazon-eventbridge-and-aws-lambda/


# Na prova eles podem pedir para que você configure um event bridge com padrões especificios.
# Se na prova pedirem para enviar um e-mail alertando a rule do AWS Config: rds-storage-encrypted it's non compliance:
# Aqui vai o setup do EventBridge:

OBS: Pode substituir o ConfigRuleName e o resourceType também!
Event Pattern:
{
  "source": [
    "aws.config"
  ],
  "detail-type": [
    "Config Rules Compliance Change"
  ],
  "detail": {
    "messageType": [
      "ComplianceChangeNotification"
    ],
    "configRuleName": [
      "rds-storage-encrypted"
    ],
    "resourceType": [
      "AWS::RDS::DBInstance"
    ],
    "newEvaluationResult": {
      "complianceType": [
        "NON_COMPLIANT"
      ]
    }
  }
}


INPUT PATH TRANFORMER:
{"awsAccountId":"$.detail.awsAccountId","awsRegion":"$.detail.awsRegion","compliance":"$.detail.newEvaluationResult.complianceType","resourceId":"$.detail.resourceId","resourceType":"$.detail.resourceType","rule":"$.detail.configRuleName","time":"$.detail.newEvaluationResult.resultRecordedTime"}

"On <time> AWS Config rule <rule> evaluated the <resourceType> with Id <resourceId> in the account <awsAccountId> region <awsRegion> as <compliance> For more details open the AWS Config console at https://console.aws.amazon.com/config/home?region=<awsRegion>#/timeline/<resourceType>/<resourceId>/configuration"
